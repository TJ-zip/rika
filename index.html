<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rika's Diversity in Living World</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        /* ... (your existing CSS rules) ... */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden; /* Prevent scrollbars on body */
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            background-color: #f0f2f5;
            color: #333;
            font-size: 16px;
            display: flex;
            flex-direction: column;
        }

        .quiz-container, .landing-container, .results-container {
            background-color: #ffffff;
            overflow: hidden;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .landing-container, .results-container {
            padding: 30px;
            text-align: center;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
            box-sizing: border-box;
        }
        .results-container {
            justify-content: flex-start; /* Align results content to top */
        }


        .landing-container h1, .results-container h1 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 2em;
            font-weight: 600;
            margin-top: 0;
        }

        .landing-container input[type="text"] {
            padding: 10px 12px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 80%;
            max-width: 300px;
            font-size: 1em;
        }

        .start-button, .nav-button, .review-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.2s ease;
            margin: 5px;
            font-weight: 500;
        }

        .start-button:hover, .nav-button:hover, .review-button:hover {
            background-color: #0056b3;
        }

        .quiz-header {
            background-color: #343a40;
            color: white;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
            height: 48px; /* Fixed height */
            box-sizing: border-box;
        }

        .quiz-header h1 {
            margin: 0;
            font-size: 1.5em;
            font-weight: 600;
        }

        .user-info {
            font-size: 0.95em;
        }

        .quiz-body {
            display: flex;
            flex-grow: 1;
            overflow: hidden;
            height: calc(100vh - 48px); /* Full height minus header */
        }

        .question-nav {
            width: 200px;
            background-color: #f8f9fa;
            padding: 15px;
            border-right: 1px solid #dee2e6;
            overflow-y: auto;
            flex-shrink: 0;
            height: 100%;
            box-sizing: border-box;
        }

        .question-nav h3 {
            margin-top: 0;
            margin-bottom: 15px;
            color: #495057;
            border-bottom: 1px solid #dee2e6;
            padding-bottom: 8px;
            font-size: 1.1em;
            font-weight: 600;
        }

        .question-nav-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(35px, 1fr));
            gap: 8px;
        }

        .question-nav-item {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 35px;
            height: 35px;
            border: 1px solid #adb5bd;
            border-radius: 50%;
            cursor: pointer;
            font-weight: normal;
            background-color: #ffffff;
            color: #495057;
            transition: background-color 0.2s, color 0.2s, border-color 0.2s;
            position: relative;
            font-size: 0.9em;
        }

        .question-nav-item:hover {
            background-color: #e9ecef;
        }

        /* Status Colors */
        .question-nav-item.status-default { background-color: #ffffff; color: #495057; border-color: #adb5bd;} /* White */
        .question-nav-item.status-answered { background-color: #28a745; color: white; border-color: #218838; } /* Green */
        .question-nav-item.status-unanswered { background-color: #dc3545; color: white; border-color: #c82333; } /* Red */
        .question-nav-item.status-review { background-color: #6f42c1; color: white; border-color: #5a32a3; } /* Purple */
        .question-nav-item.status-answered-review { background-color: #6f42c1; color: white; border-color: #5a32a3; } /* Purple + Green Dot */

        /* Green dot for answered and reviewed */
        .question-nav-item.status-answered-review::after {
            content: '';
            position: absolute;
            top: 2px;
            right: 2px;
            width: 7px;
            height: 7px;
            background-color: #28a745; /* Green dot */
            border-radius: 50%;
            border: 1px solid white;
        }


        .main-content {
            flex-grow: 1;
            padding: 25px;
            display: flex;
            flex-direction: column;
            /* justify-content: space-between; REMOVED - Let content flow naturally */
            overflow-y: auto; /* Allow scrolling for the whole main area */
            height: 100%;
            box-sizing: border-box;
        }

        .timers {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 1em;
            font-weight: 500;
            color: #495057;
            flex-shrink: 0;
        }

        .timer {
            background-color: #e9ecef;
            padding: 6px 12px;
            border-radius: 4px;
            border: 1px solid #ced4da;
        }
        .timer.red {
            color: #dc3545;
            border-color: #dc3545;
            font-weight: 600;
        }

        .question-area-wrapper { /* Wrapper for question and options */
             /* Allow this area to take up available space before buttons */
             flex-grow: 1;
             margin-bottom: 20px; /* Space before buttons */
             /* Removed overflow-y: auto; let main-content handle scrolling */
        }

        .question-text {
            font-size: 1.2em;
            margin-bottom: 20px;
            line-height: 1.5;
            color: #212529;
            font-weight: 500;
        }

        /* --- NEW: Image Container Styling --- */
        #question-image-container {
             margin-bottom: 20px; /* Space between image and options */
             text-align: center; /* Center the image */
        }
        #question-image-container img {
             max-width: 100%; /* Make image responsive */
             height: auto;    /* Maintain aspect ratio */
             max-height: 300px; /* Optional: Limit max height */
             border-radius: 4px; /* Optional: Rounded corners */
             box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* Optional: Slight shadow */
        }
         /* --- END NEW --- */

        .options {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        .options li {
            margin-bottom: 10px;
        }

        .options label {
            display: block;
            background-color: #f8f9fa;
            border: 1px solid #ced4da;
            padding: 12px 15px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s, border-color 0.2s;
            font-size: 1em;
            font-weight: normal;
        }

        .options input[type="radio"] {
            margin-right: 10px;
            display: none;
        }

         .options label:hover {
             background-color: #e2e6ea;
             border-color: #adb5bd;
         }

        .options input[type="radio"]:checked + label {
            background-color: #cfe2ff;
            border-color: #007bff;
            font-weight: 500;
            color: #0056b3;
        }


        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            border-top: 1px solid #dee2e6;
            padding-top: 15px;
            /* margin-top: auto; REMOVED - Let it sit naturally at the bottom */
            flex-shrink: 0; /* Prevent buttons area from shrinking */
        }

        .nav-button.prev { background-color: #ffc107; color: #212529;}
        .nav-button.prev:hover { background-color: #e0a800; }
        .review-button { background-color: #6f42c1; }
        .review-button:hover { background-color: #5a32a3; }
        .nav-button.next { background-color: #28a745; }
        .nav-button.next:hover { background-color: #218838; }
        .nav-button:disabled {
            background-color: #adb5bd;
            cursor: not-allowed;
            opacity: 0.7;
        }
        .nav-button.submit { background-color: #dc3545; }
        .nav-button.submit:hover { background-color: #c82333; }


        /* Results Page Specifics */
        .results-content {
             width: 100%;
             max-width: 900px;
             margin: 0 auto;
             padding: 20px 0;
        }

        .score-card {
            background-color: #e6f7ff;
            border: 1px solid #007bff;
            padding: 15px 20px;
            margin-bottom: 25px;
            border-radius: 5px;
        }
        .score-card h2 {
            margin-top: 0;
            margin-bottom: 10px;
            color: #0056b3;
            font-size: 1.5em;
            font-weight: 600;
        }
        .score-card p {
            font-size: 1.2em;
            font-weight: 500;
            color: #343a40;
            margin: 5px 0;
        }

        .results-section {
            margin-bottom: 25px;
            text-align: left;
            padding: 15px;
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
        }

        .results-section h3 {
            color: #495057;
            border-bottom: 1px solid #dee2e6;
            padding-bottom: 8px;
            margin-bottom: 15px;
            font-size: 1.2em;
            font-weight: 600;
        }

        .result-item {
            border-bottom: 1px dashed #ced4da;
            padding: 12px 0;
        }
        .result-item:last-child {
            border-bottom: none;
        }
        .result-item p {
            margin: 4px 0;
            font-size: 1em;
            line-height: 1.4;
        }
        .result-item .question { font-weight: 600; color: #343a40; }
        .result-item .your-answer { color: #dc3545; font-weight: 500;}
        .result-item .correct-answer { color: #28a745; font-weight: 500;}
        .result-item .explanation { font-style: normal; color: #6c757d; margin-top: 8px; font-size: 0.95em;}

        .time-analysis {
             padding: 15px;
             background-color: #f8f9fa;
             border: 1px solid #dee2e6;
             border-radius: 5px;
             margin-bottom: 20px;
        }
        .time-analysis h3 {
             color: #495057;
             border-bottom: 1px solid #dee2e6;
             padding-bottom: 8px;
             margin-bottom: 15px;
             text-align: left;
             font-size: 1.2em;
             font-weight: 600;
        }
        #timeChart {
            max-height: 350px;
            width: 100% !important;
        }

        /* Hide elements */
        .hidden {
            display: none !important;
        }

    </style>
</head>
<body>

    <!-- Landing Page -->
    <div id="landing-page" class="landing-container">
        <h1>Welcome Rika!</h1>
        <input type="text" id="name-input" placeholder="You can change the">
        <br>
        <button id="start-quiz-button" class="start-button">Start Quiz</button>
    </div>

    <!-- Quiz Page -->
    <div id="quiz-page" class="quiz-container hidden">
        <div class="quiz-header">
            <h1>Diversity in Living World</h1>
            <div class="user-info">
                <span>Name: <span id="user-name"></span></span> |
                <span>Total Time Left: <span id="total-timer">05:00</span></span>
            </div>
        </div>
        <div class="quiz-body">
            <div class="question-nav">
                <h3>Question Palette</h3>
                <ul id="question-nav-list" class="question-nav-list">
                    <!-- Question numbers will be dynamically added here -->
                </ul>
            </div>
            <div class="main-content">
                <!-- Top content wrapper -->
                <div class="timers">
                    <span id="current-question-number">Question X of Y</span>
                    <span class="timer" id="question-timer">Time: 0s</span>
                </div>
                <!-- Scrollable question area -->
                <div class="question-area-wrapper">
                    <p id="question-text" class="question-text">Question text goes here...</p>
                    <!-- === NEW: Image container === -->
                    <div id="question-image-container"></div>
                    <!-- === END NEW === -->
                    <ul id="options-list" class="options">
                        <!-- Options will be dynamically added here -->
                    </ul>
                </div>
                 <!-- Navigation buttons at the bottom -->
                <div class="navigation-buttons">
                    <button id="prev-button" class="nav-button prev">Previous</button>
                    <button id="review-button" class="review-button">Mark for Review</button>
                    <button id="next-button" class="nav-button next">Next</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Results Page -->
    <div id="results-page" class="results-container hidden">
       <div class="results-content">
            <h1>Quiz Results</h1>
            <div id="score-card" class="score-card">
                <h2>Score</h2>
                <p><span id="score">0</span> / <span id="total-marks">0</span></p>
                 <p>Well done, <span id="result-user-name">User</span>!</p>
            </div>

            <div id="wrong-unanswered-list" class="results-section">
                <h3>Review Incorrect & Unanswered Questions</h3>
                <!-- Incorrect/Unanswered questions will be added here -->
            </div>

            <div class="time-analysis">
                 <h3>Time Analysis Per Question</h3>
                <canvas id="timeChart"></canvas>
            </div>
             <button onclick="window.location.reload();" class="start-button">Restart Quiz</button>
        </div>
    </div>

    <script>
                const quizData = [
            {
                question: "Which of the following are part of biotechnology?",
                options: ["In-vitro fertilisation leading to test tube baby", "Synthesising a gene", "Developing a DNA vaccine", "All of the above"],
                answer: "All of the above",
                explanation: "Biotechnology deals with techniques of using live organisms and enzymes from organisms to produce products and processes are useful to humans"
            },
            {
                question: "Which of the following is the definition given by the European Federation of biotechnology that encompasses both traditional views and modern molecular biotechnology?",
                options: ["the innovation of natural science and organism’s cells, parts thereof, and molecular analogues for products and services", "the integration of natural science and organism’s cells, parts thereof, and molecular analogue for products and services", "the inactivation of natural science and organisms cells, parts thereof, and molecular analogue for products and services", "the integration of organisms cells, parts thereof, and molecular analogue for products and services"],
                answer: "the integration of natural science and organism’s cells, parts thereof, and molecular analogue for products and services",
                explanation: "many definitions of biotechnology have been proposed but this definition encompasses both traditional view and the modern molecular biotechnology view also"
            },
            {
                question: "Which of the following techniques enables the birth of modern biotechnology?",
                options: ["Plant breeding", "Genetic engineering", "Bioprocess engineering", "Both (b) and (c)"],
                answer: "Both (b) and (c)",
                explanation: "Genetic engineering and Biotechnology engineering are the basis of the origin of modern biotechnology"
            },
            {
                question: "What is genetic engineering?",
                options: ["it is a technique to alter the chemistry of genetic material DNA", "it is a technique to alter the chemistry of genetic material RNA", "it is a technique to alter the chemistry of genetic material DNA and RNA", "it is a technique to alter the chemistry of genetic material protein"],
                answer: "it is a technique to alter the chemistry of genetic material DNA and RNA",
                explanation: "Genetic engineering alters the genetic material DNA or RNA and then it is introduced into the host organism so as to change the phenotype of the host organism"
            },
            {
                question: "Genetic engineering includes.",
                options: ["Creation of recombinant DNA", "Gene cloning", "Gene transfer", "All of the above"],
                answer: "All of the above",
                explanation: "Genetic engineering allows us to isolate and introduce only a set of desirable genes without introducing the undesirable genes into the target organism"
            },
            {
                question: "Which of the following is responsible for initiating replication in a chromosome?",
                options: ["Promoter", "Origin of replication", "Plasmid", "None of the above"],
                answer: "Origin of replication",
                explanation: "Origin of replication is a specific DNA sequence on the chromosome that is responsible for initiating replication"
            },
            {
                question: "What is cloning?",
                options: ["making single identical copy of any template DNA", "making multiple identical copies of any template DNA", "making multiple identical copies of any protein", "making multiple identical copies of chromosome"],
                answer: "making multiple identical copies of any template DNA",
                explanation: "Cloning is done when an alien DNA is linked with the origin of replication so that this is alien piece of DNA can replicate and multiply itself in the host organism"
            },
            {
                question: "What is gene transfer?",
                options: ["the introduction of new protein in an existing organism cell", "the introduction of new DNA in an existing organism cell", "the introduction of new RNA in an existing organism cell", "the introduction of chromosome in an existing organism cell"],
                answer: "the introduction of new DNA in an existing organism cell",
                explanation: "Gene transfer is an important aspect of genetic engineering"
            },
            {
                question: "What is a plasmid?",
                options: ["it is an autonomously replicating circular extrachromosomal DNA", "it is an autonomously replicating linear extrachromosomal DNA", "it is an autonomously replicating circular chromosomal DNA", "it is an autonomously replicating circular extrachromosomal RNA"],
                answer: "it is an autonomously replicating circular extrachromosomal DNA",
                explanation: "A plasmid was used for the construction of the first recombinant DNA by combining it with a gene encoding antibiotic resistance"
            },
            {
                question: "Who among the following accomplished the construction of the first component DNA in 1972?",
                options: ["Von Bear", "Alexander Fleming", "Stanley Cohen and Herbert Boyer", "Ernst Heckel"],
                answer: "Stanley Cohen and Herbert Boyer",
                explanation: "Stanley Cohen and Herbert Boyer accomplished the construction of first recombinant DNA by isolating the antibiotic resistance gene by cutting out a piece of DNA from a plasmid which was responsible for conferring antibiotic resistance"
            },
            {
                question: "Which of the following is also referred to as molecular scissors?",
                options: ["Polymerases", "Restriction enzymes", "Transcriptase", "None of the above"],
                answer: "Restriction enzymes",
                explanation: "The discovery of restriction enzyme made the cutting of DNA at specific location very easy"
            },
            {
                question: "What is the use of vector in biotechnology?",
                options: ["They help in the transfer of piece of RNA attached to it", "They help in the transfer of piece of protein attached to it", "They help in the transfer of piece of DNA attached to it", "They help in the transfer of piece of chromosome attached to it"],
                answer: "They help in the transfer of piece of DNA attached to it",
                explanation: "Just as a mosquito acts as an insect vector to transfer the malarial parasite into the human body in the same way vectors like plasmid in biotechnology help in the transfer of a piece of DNA attached to it"
            },
            {
                question: "Which of the following enzyme at once cut DNA molecules and join their ends?",
                options: ["DNA polymerase", "Restriction enzymes", "DNA ligase", "Reverse transcriptase"],
                answer: "DNA ligase",
                explanation: "Linking of any antibiotic resistance gene with the plasmid vector becomes easy with the help of enzyme DNA ligase that has a property to join cut ends of DNA"
            },
            {
                question: "Which of the following enzyme always cut DNA molecules at a particular point by recognising a specific sequence of 6 base pairs?",
                options: ["Bam H 1", "Eco R 1", "Hind II", "Hind III"],
                answer: "Hind II",
                explanation: "Hind II was the first restriction endonuclease to be discovered and it always cuts DNA molecules a particular point by recognising 6 place face sequence"
            },
            {
                question: "How many restriction enzymes have been discovered till now?",
                options: ["More than 1000", "More than 900", "More than 800", "More 700"],
                answer: "More than 900",
                explanation: "till now more than 900 restriction enzymes have been isolated from over 230 strains of bacteria each of which recognise different recognition sequences"
            },
            {
                question: "Which of the following is a source of Eco R 1?",
                options: ["Escherichia coli RY11", "Escherichia coli RY12", "Escherichia coli RY13", "Escherichia coli RY14"],
                answer: "Escherichia coli RY11",
                explanation: "Eco R 1 comes from Escherichia coli RY11"
            },
            {
                question: "Which among the following is the function of exonucleases?",
                options: ["the remove nucleotides from the middle of the DNA", "the remove nucleotides from the ends of the DNA", "the remove nucleotides from the template DNA", "the remove nucleotides from newly processed DNA"],
                answer: "the remove nucleotides from the ends of the DNA",
                explanation: "exonucleases belong to the class of enzyme nucleases and remove nucleotides from the ends of the DNA"
            },
            {
                question: "Which of the following is correct about restriction endonucleases?",
                options: ["they recognise a specific nucleotide sequence in the DNA", "they recognise a specific palindromic sequence in the DNA", "they recognise a specific palindromic nucleoside sequence in the DNA", "they recognise a specific palindromic nucleotide sequences in the DNA"],
                answer: "they recognise a specific palindromic nucleotide sequences in the DNA",
                explanation: "restriction endonucleases are very specific in their function, once it finds it specific points in the sequence it binds to the DNA and cut each of the two strands of the double helix in the sugar phosphate backbone"
            },
            {
                question: "What is the charge on the DNA molecule?",
                options: ["Positive charge", "Neutral", "Negative charge", "None of the above"],
                answer: "Negative charge",
                explanation: "the charge on DNA is negative, this property is widely used to separate DNA fragments using gel electrophoresis technique"
            },
            {
                question: "Name the matrix that is used to separate DNA fragments using gel electrophoresis.",
                options: ["Cellulose", "Agar", "Agarose", "Starch"],
                answer: "Agarose",
                explanation: "agarose is a natural polymer extracted from seaweeds"
            },
            {
                question: "Which of the following compound is used to stain the separated DNA fragments to view them under the UV radiation?",
                options: ["Methyl orange", "Ethidium bromide", "Methyl red", "Naphthol green B"],
                answer: "Ethidium bromide",
                explanation: "after staining the separated DNA fragments with ethidium bromide, one can see orange colour bands of DNA under UV light"
            },
            {
                question: "Which of the following is responsible for controlling the copy number of the linked DNA during replication?",
                options: ["Selectable marker", "Origin of replication", "Cloning sites", "Promoter"],
                answer: "Origin of replication",
                explanation: "origin of replication is a sequence from where replication starts, any piece of DNA when linked to the sequence can be made to replicate within the host cell, it also controls the copy number of the linked-to DNA"
            },
            {
                question: "What is transformation?",
                options: ["it is a procedure through which a piece of RNA is introduced into a host bacterium", "it is a procedure through which a piece of protein is introduced into a host bacterium", "it is a procedure through which a piece of chromosome is introduced into a host bacterium", "it is a procedure through which a piece of DNA is introduced into a host bacterium"],
                answer: "it is a procedure through which a piece of DNA is introduced into a host bacterium",
                explanation: "transformation is a procedure of introducing a novel piece of DNA inside the host cell"
            },
            {
                question: "Which of the following diavalent cation is used to increase the efficiency of DNA so that it easily enters the bacterium through the pores present in its walls?",
                options: ["Magnesium", "Barium", "Calcium", "All of the above"],
                answer: "Calcium",
                explanation: "Diavalent cation like calcium increases the porosity of the bacterial wall and introduces the r-DNA into the bacterial cell"
            },
            {
                question: "Which of the following metal is used for DNA in the host cell through gene gun technology? (i) Silver (ii) Gold (iii) Tungsten (iv) Both (b) and (c)",
                options: ["Silver", "Gold", "Tungsten", "Both (b) and (c)"],
                answer: "Both (b) and (c)",
                explanation: "In gene gun, DNA particles are coated in the gold or tungsten and then injected directly in the host body."
            },
            {
                question: "Which of the following enzyme is used to treat the bacterial cells for the isolation of DNA?",
                options: ["Lysozyme", "Cellulase", "Chitinase", "All of the above"],
                answer: "Lysozyme",
                explanation: "Lysozyme is used to treat bacterial cells for the isolation of DNA by breaking down the cell wall."
            },
            {
                question: "Which of the following can be used to remove RNA during DNA isolation procedure?",
                options: ["Proteases", "Ribonucleases", "DNAses", "Restriction endonucleases"],
                answer: "Ribonucleases",
                explanation: "DNA is interwined with protein, histones. RNA is also present that can be removed with the help of enzyme ribonuclease"
            },
            {
                question: "Which of the following is used to precipitate purified DNA during the procedure of DNA isolation?",
                options: ["Chilled methanol", "Chilled water", "Chilled ethanol", "Chilled buffer"],
                answer: "Chilled ethanol",
                explanation: "chilled ethanol easily precipitates the purified DNA out of the test tube"
            },
            {
                question: "Which of the following is the correct form of PCR?",
                options: ["Polymer Chain Reaction", "Pole Chain Reaction", "Prime Chain Reaction", "Polymerase Chain Reaction"],
                answer: "Polymerase Chain Reaction",
                explanation: "polymerase chain reaction is a reaction in which multiple copies of a gene of interest is synthesized in vitro using two sets of primers and the enzyme DNA polymerase"
            },
            {
                question: "What is a recombinant protein?",
                options: ["it is a protein encoding DNA that is expressed in a heterologous host", "it is a protein encoding gene that is expressed in a heterologous host", "it is a protein encoding RNA that is expressed in a heterologous host", "it is a protein encoding ribosome that is expressed in a heterologous host"],
                answer: "it is a protein encoding gene that is expressed in a heterologous host",
                explanation: "the desired protein can be extracted from the cloned genes and can be used for any purpose"
            },
            {
                question: "In gel electrophoresis, DNA fragments are separated on the basis of.",
                options: ["Charge", "Size", "Weight", "All of the above"],
                answer: "Size",
                explanation: "in gel electrophoresis the DNA fragments resolve according to the size due to the sieving effect provided by the agrose gel"
            },
            {
                question: "Which of the following helps in the selection of transformed cells on a Petri dish?",
                options: ["Antibiotic resistance gene", "Recognition sites", "Cloning sites", "Ori C"],
                answer: "Antibiotic resistance gene",
                explanation: "antibiotic resistance genes act as a marker on the vector that helps in selection of the transformed cells"
            },
            {
                question: "Eco R1 is a restriction enzyme. In the name, what does ‘co’ stands for?",
                options: ["Colon", "Coli", "Coffee", "Coenzyme"],
                answer: "Coli",
                explanation: "Eco R 1 the letter R is derived from the name of the strain and ‘co’ stands for coli"
            },
            {
                question: "Which of the following is the source of restriction endonucleases?",
                options: ["Fungal cells", "Bacterial cells", "Plant cells", "Virus"],
                answer: "Bacterial cells",
                explanation: "in the 1963, two enzymes responsible for restricting the growth of bacteriophages in E.coli were isolated. Later more research was made and were found useful, so they were commercially isolated from bacterial cells for research purposes."
            },
            {
                question: "After running gel electrophoresis, the extraction of DNA fragments from agarose gel is called as.",
                options: ["Cutting", "Elution", "Separation", "Ligation"],
                answer: "Elution",
                explanation: "the separated bands of DNA are cut out from the agarose gel and extracted from the gel piece, this step is called as elution"
            },
            {
                question: "Which of the following is a protein digesting enzyme?",
                options: ["Chitinase", "Cellulase", "Protease", "Lipase"],
                answer: "Protease",
                explanation: "protein can be easily removed from DNA by treating it with an enzyme called proteases"
            },
            {
                question: "Which of the following is correct about plasmid?",
                options: ["It is bacteria", "It is extra chromosomal DNA", "It is a plant", "It is virus"],
                answer: "It is extra chromosomal DNA",
                explanation: "Plasmid is autonomously replicating unit present in bacterial cells"
            },
            {
                question: "What are bacteriophages?",
                options: ["They are fungus that infect bacteria", "They are virus that infect bacteria", "They are protozoans that infect bacteria", "They are helminths that bacteria"],
                answer: "They are virus that infect bacteria",
                explanation: "Bacterial cells can also be infected by pathogens, like virus as they infect humans and plants, such virus is called bacteriophages"
            },
            {
                question: "What are basic steps of genetically modifying an organism?",
                options: ["identification of DNA with desirable genes", "introduction of the identified DNA into the host", "maintenance of introduce DNA in the host and transfer the DNA to its progeny", "All of the above"],
                answer: "All of the above",
                explanation: "All the above 3 are the 3 basic steps of genetically modifying an organism."
            },
            {
                question: "Which of the following cannot be included under biotechnology?",
                options: ["Development of COVID vaccine", "Test tube baby technique", "Setting of curd", "Treating defective gene"],
                answer: "Setting of curd",
                explanation: "biotechnology is a restricted sense today it is used to refer to such processes which use genetically modified organisms to achieve the same on a larger scale"
            },
            {
                question: "Which of the following is the correct full form of EFB?",
                options: ["European Federation of Biotechnology", "Eastern Federation of Biotechnology", "Ethopian Federation of Biotechnology", "European Federation of Biology"],
                answer: "European Federation of Biotechnology",
                explanation: "the European Federation of biotechnology has given a definition of biotechnology that encompasses both traditional view and modern molecular biotechnology"
            },
            {
                question: "What is the meaning of annealing in PCR technique?",
                options: ["It is the joining of RNA primers to the template DNA", "It is the joining of DNA primers to the template DNA", "It is the joining of protein to the template DNA", "It is the joining of DNA primers RNA"],
                answer: "It is the joining of DNA primers to the template DNA",
                explanation: "Annealing during PCR is achieved when the temperature is lowered in the machine as per the set protocol."
            },
            {
                question: "Taq polymerase is isolated from.",
                options: ["Thermus aquaticaus", "Aspergillus niger", "Clostridium butylicum", "None of the above"],
                answer: "Thermus aquaticaus",
                explanation: "taq polymerase is a thermostable DNA polymerase that is isolated from the bacterium Thermus aquaticus and remains active during the high temperature induced denaturation of double stranded DNA"
            },
            {
                question: "What is the number of steps in each cycle of PCR?",
                options: ["1", "2", "3", "4"],
                answer: "3",
                explanation: "Each cycle of PCR has three steps denaturation, primer annealing and extension of primers"
            },
            {
                question: "What is denaturation of DNA?",
                options: ["It is the separation of ss DNA into strands", "It is the separation of ds RNA into single strands", "It is the separation of ss RNA into single strands", "It is the separation of ds DNA into single strands"],
                answer: "It is the separation of ds DNA into single strands",
                explanation: "denaturation is the first step of PCR, in this the double stranded DNA opens and converts into single strand so that the primers can anneal"
            },
            {
                question: "Look at the diagram given below and name ‘A’. ",
                options: ["DNA ligae", "Reverse transcriptase", "Proteases", "Taq polymerase"],
                answer: "Taq polymerase",
                explanation: "Taq polymerase helps in the extension of the primers using deoxynucleotides.",
                imageSrc: "placeholder_for_image_q46.png" // Add the image source here when available
            },
            {
                question: "What are the optimum growth conditions for large scale production of cultures in a bioreactor?",
                options: ["Temprature, oxygen", "pH, vitamins", "Substrate and salts", "All of the above"],
                answer: "All of the above",
                explanation: "a bioreactor is used to produce large volumes of cultures to obtain the desired protein for the desired product"
            },
            {
                question: "What are palindromic sequences?",
                options: ["A sequence on ds DNA or RNA which if read in one direction is identical to sequence in the same direction on the complementary strand also.", "A sequence on only ds DNA which if read in one direction is identical to sequence in the same direction on the complementary strand also.", "A sequence on ds RNA which if read in one direction is identical to sequence in the same direction on the complementary strand also.", "A sequence on protein if read in one direction is identical to sequence in the same direction on the complementary strand also."],
                answer: "A sequence on ds DNA or RNA which if read in one direction is identical to sequence in the same direction on the complementary strand also.",
                explanation: "palindromic sequences are very important in biotechnology, the restriction enzymes cut the strand of DNA a little away from the centre of the palindromic site but between the same two bases on the opposite strands"
            },
            {
                question: "Which of the following is not a restriction enzyme?",
                options: ["Bam H1", "Hind III", "Eco RI", "Lipase"],
                answer: "Lipase",
                explanation: "Lipase is an enzyme that breaks down fats, not DNA."
            },
            {
                question: "Sticky ends of DNA fragments during recombinant DNA technology can be joined by.",
                options: ["DNA polymerase", "RNA polymerase", "DNA ligase", "Taq polymerase"],
                answer: "DNA ligase",
                explanation: "DNA ligases effectively joins the sticky ends of DNA during r-DNA technology."
            },
            // Practice Questions Q1-Q30
            {
                question: "Which of the following tools of recombinant DNA technology is incorrectly paired with its use?",
                options: ["restriction enzyme - Production of RFLPs", "DNA ligase-that cuts DNA, creating the sticky ends", "DNA polymerase - used in a polymerase chain reaction to amplify section of DNA", "reverse transcriptase - production of cDNA from mRNA"],
                answer: "DNA ligase-that cuts DNA, creating the sticky ends",
                explanation: "Restriction enzymes cut DNA creating sticky ends of restriction fragments. While DNA ligase joins these sticky ends to form recombinant DNA."
            },
            {
                question: "In r-DNA technology or genetic engineering elution means.",
                options: ["Remove the DNA from centrifuge tube after centrifugation", "The separated band of DNA are cut out from the gel and extracted from the gel piece", "Separation of the recombinant protein from recombinant cell", "Insertion of recombinant DNA into the host cell"],
                answer: "The separated band of DNA are cut out from the gel and extracted from the gel piece",
                explanation: "cutting and extraction of DNA is done to separate the DNA from the gel in which it is collected. Water or a low salt buffer is added to break the cation bridge and dislodge the DNA from the gel and elute it."
            },
            {
                question: "If a recombinant DNA bearing gene for ampicillin resistance if transferred into E.Coli cells and the host cells are spread on agar plates containing ampicillin, then.",
                options: ["both transformed and untransformed recipient cells will die", "both transformed and untrasformed recipient cell will be grow", "tranformed recipient cells will grow and untransformed recipient cells will die", "transformed recipient cells will die and untransformed recipient cells will grow"],
                answer: "tranformed recipient cells will grow and untransformed recipient cells will die",
                explanation: "The cloning vector requires the presence of a selectable marker, which helps in identifying and eliminating non-transformants and selectively permitting the growth of the transformants. Normally, the genes encoding resistance to antibiotics such as ampicillin, chloramphenicol, tetracycline or kanamycin, etc. are considered useful selectable markers for E. coli. The normal E.coli cells do not carry resistance against any of these antibiotics."
            },
            {
                question: "The technique that serves the purpose of early diagnosis of disease or pathogen.",
                options: ["Recombinant DNA technology", "Polymerase chain reaction", "Enzyme linked immuno sorbent assay", "All the above"],
                answer: "All the above",
                explanation: "Recombinant DNA technology, PCR, and ELISA are all techniques used in the early diagnosis of diseases or pathogens."
            },
            {
                question: "To denature the DNA template in PCR it is heated to.",
                options: ["70°C", "54°C", "80°C", "94°C"],
                answer: "94°C",
                explanation: "During this stage the cocktail containing the template DNA and all the other core ingredients is heated to 94-95⁰C."
            },
            {
                question: "Most common matrix is agarose a natural polymer used in gel electrophoresis is extracted from.",
                options: ["an animal", "a fungus", "Sea weeds", "None of these"],
                answer: "Sea weeds",
                explanation: "the most commonly used matrix is agarose which is a natural polymer extracted from seaweeds."
            },
            {
                question: "If the bacterium does not have any insert, then in the presence of chromogenic substrate, it gives.",
                options: ["Red coloured colonies", "Colourless colonies", "Blue colonies", "Green colonies"],
                answer: "Blue colonies",
                explanation: "the presence of a chromogenic substrate gives blue coloured colonies if the plasmid in the bacteria does not have an insert. Presence of insert results into insertional inactivation of the -galactosidase and the colonies do not produce any colour, these are identified as recombinant colonies."
            },
            {
                question: "Insertional inactivation results into inactivation of which enzyme?",
                options: ["Transacetylase", "Permease", "Taq polymerase", "-galactosidase"],
                answer: "-galactosidase",
                explanation: "he presence of a chromogenic substrate gives blue coloured colonies if the plasmid in the bacteria does not have an insert. Presence of insert results into insertional inactivation of the -galactosidase and the colonies do not produce any colour, these are identified as recombinant colonies."
            },
            {
                question: "The sequence which is responsible for controlling the copy number of the linked DNA is.",
                options: ["Coding sequence", "Promoter sequence", "Terminator sequence", "Ori"],
                answer: "Ori",
                explanation: "Ori site or the site of origin controls replication in circular plasmid DNA and hence, the copy number of linked DNA in the vector."
            },
            {
                question: "If any protein encoding gene is expressed in a hetero logous host then protein is known as.",
                options: ["Recombinant gene", "Recombinant protein", "Selectable marker", "Homogenous protein"],
                answer: "Recombinant protein",
                explanation: "the protein is called a recombinant protein."
            },
            {
                question: "Group of letters that form the same words when read both forward and backward is called.",
                options: ["Palindrome", "Same words", "Opposite words", "None of the above"],
                answer: "Palindrome",
                explanation: "such group of letters are called palindrome."
            },
            {
                question: "The enzymes, which remove nucleotides from the ends of the DNA are.",
                options: ["Exonuclease", "Endonuclease", "Cellulase", "Hydrolase"],
                answer: "Exonuclease",
                explanation: "exonucleases are the enzymes that are necessary for proofreading and removing the nucleotides from the DNA ends and the endonucleases are the enzymes that cut DNA at specific positions."
            },
            {
                question: "When the isolation of genetic material is done the RNA can be removed by treatment with.",
                options: ["Protease", "Chitinase", "Ribonuclease", "Deoxyribonuclease"],
                answer: "Ribonuclease",
                explanation: "removal of RNA can be done by ribonucleases and proteins can be done by protease."
            },
            {
                question: "Roman numbers following the names of restriction endonuclease indicate.",
                options: ["The order in which the enzymes were isolated from that strain of bacteria", "strain of bacteria", "the order in which genus is taken to isolate the enzyme", "none of the above"],
                answer: "The order in which the enzymes were isolated from that strain of bacteria",
                explanation: "The Roman numerals are used to identify specific enzymes from bacteria that contain multiple restriction enzymes. Typically, the Roman numeral indicates the order in which restriction enzymes were discovered in a particular strain."
            },
            {
                question: "Which one of the following is must in Genetic engineering?",
                options: ["Restriction endonuclease + DNA ligase + polymerases", "Restriction exonuclease + DNA polymerase", "Alkaline phosphate + DNA Ligase", "RNA polymerase + DNA polymerase"],
                answer: "Restriction endonuclease + DNA ligase + polymerases",
                explanation: "Key tools for recombinant DNA technology are restriction endonuclease enzyme and DNA ligases for recombinant DNA production, vectors that help in carrying and integrating the desired gene, host organism is that one in which recombinant DNA is introduced, polymerase enzymes"
            },
            {
                question: "In the vector pBR322 there is.",
                options: ["One selectable marker", "Two selectable markers", "Three selectable markers", "None of the above"],
                answer: "Two selectable markers",
                explanation: "In the cloning vector pBR322, ampicillin and tetracycline resistance genes are the selectable markers. The role they play is that they help in the selection of transformed cells from non transformed cells. They also help distinguish recombinant cells from non-recombinant cells."
            },
            {
                question: "The enzymes responsible for restricting the growth of bacteriophage in E-coli were isolated in 1963, these enzyme are.",
                options: ["DNA ligases", "Alkaline phosphatases", "DNA polymerases", "Restriction endonuclease"],
                answer: "Restriction endonuclease",
                explanation: "they were restriction endonucleases."
            },
            {
                question: "During the process of gene amplification using PCR, if very high temperature is not maintained in the beginning, then which of the following steps of PCR will be affected first?",
                options: ["Annealing", "Extension", "Denaturation", "Ligation"],
                answer: "Denaturation",
                explanation: "the denaturation step will be affected."
            },
            {
                question: "DNA strands on a gel stained with ethidium bromide when viewed under UV radiation, appear as.",
                options: ["Yellow bands", "Bright orange bands", "Dark red bands", "Bright blue bands"],
                answer: "Bright orange bands",
                explanation: "the DNA stained with ethidium bromide when viewed under UV light appear bright orange."
            },
            {
                question: "Which of the following is a correct sequence of steps in a PCR (Polymerase Chain Reaction)?",
                options: ["Denaturation, Annealing, Extension", "Denaturation, Extension, Annealing", "Extension, Denaturation, Annealing", "Annealing, Denaturation, Extension"],
                answer: "Denaturation, Annealing, Extension",
                explanation: "Polymerase chain reaction or PCR consists of the following three steps: Denaturation- The two DNA strands of template DNA separate from each other when heated to 92℃, next is annealing- The primers anneal to the 3’ end of single strands of DNA and the last is extension- The primers are extended by DNA polymerase by the addition of nucleotides to form complete strands of DNA. Hence the sequence of steps is denaturation, annealing, extension."
            },
            {
                question: "The laws and rules to prevent unauthorised exploitation of bio-resources are termed as.",
                options: ["Biopatenting", "Bioethics", "Bioengineering", "Biopiracy"],
                answer: "Biopatenting",
                explanation: "a patent is a, intellectual property right that provides the owner the legal right to ensure that no one else benefits from making, using or selling an invention."
            },
            {
                question: "In Recombinant DNA technology antibiotics are used.",
                options: ["to keep medium bacteria-free", "to detect alien DNA", "to impart disease-resistance to the host plant", "as selectable markers"],
                answer: "as selectable markers",
                explanation: "Vectors carry an antibiotic-resistant gene which helps to select the recombinant cells from nonrecombinant ones as only recombinant cells would exhibit the antibiotic resistance and would be able to survive on antibiotic rich medium. Such genes that the host cell requires for growth under certain conditions and differentiate the recombinant cells from non-recombinant ones are called as selectable markers."
            },
            {
                question: "In a mixture, DNA fragments are separated by.",
                options: ["Bioprocess engineering", "Restriction digestion", "Electrophoresis", "Polymerase chain reaction"],
                answer: "Electrophoresis",
                explanation: "in electrophoresis, the negatively charged DNA moves from negative terminal to the positive terminal."
            },
            {
                question: "Identify the wrong statement with regard to Restriction Enzymes.",
                options: ["Sticky ends can be joined by using DNA ligases.", "Each restriction enzyme functions by inspecting the length of a DNA sequence.", "They cut the strand of DNA at palindromic sites.", "They are useful in genetic engineering."],
                answer: "Sticky ends can be joined by using DNA ligases.",
                explanation: "This statement describes the function of DNA ligases in joining sticky ends created by restriction enzymes, rather than a function of restriction enzymes themselves."
            },
            {
                question: "A selectable marker is used to.",
                options: ["help in eliminating the non-transformants, so that the transformants can be regenerated", "identify the gene for a desired trait in an alien organism", "select a suitable vector for transformation in a specific crop", "mark a gene on a chromosome for isolation using restriction enzyme"],
                answer: "help in eliminating the non-transformants, so that the transformants can be regenerated",
                explanation: "Only those cells which have been transformed successfully can be traced by marker. So, this helps in eliminating non-transformants and permitting transformants."
            },
            {
                question: "A gene whose expression helps to identify transformed cell is known as.",
                options: ["Vector", "Plasmid", "Structural gene", "Selectable marker"],
                answer: "Selectable marker",
                explanation: "In recombinant DNA technology, selectable markers are the specific genes that are used to identify the transformants from the nontransformants after the process of recombination. These genes are used to detect whether the incorporation of a nucleic acid sequence has been successful into an organism's DNA."
            },
            {
                question: "Which of the following is a restriction endonuclease?",
                options: ["Hind II", "Protease", "DNase I", "RNase"],
                answer: "Hind II",
                explanation: "A restriction enzyme or restriction endonuclease is an enzyme that cleaves DNA into fragments at or near specific recognition sites within the molecule known as restriction sites. Restrictions enzymes are one class of the broader endonuclease group of enzymes."
            },
            {
                question: "Which vector can clone only a small fragment of DNA?",
                options: ["Bacterial artificial chromosome", "Yeast artificial chromosome", "Plasmid", "Cosmid"],
                answer: "Plasmid",
                explanation: "Plasmids are autonomously replicating circular extra-chromosomal DNA. They are the standard cloning vectors and the ones most commonly used. Most general plasmids may be used to clone DNA insert of up to 15 kb in size."
            },
            {
                question: "Biolistics (gene-gun) is suitable for.",
                options: ["Constructing recombinant DNA by joining with vectors", "DNA finger printing", "Disarming pathogen vectors", "Transformation of plants cells"],
                answer: "Transformation of plants cells",
                explanation: "The biolistic method is a method of transformation of plants. It is used to transfer foreign DNA into a plant cell. For the purpose, cells are bombarded with high-velocity micro-particles of gold or tungsten coated with DNA."
            },
            {
                question: "For transformation, micro-particles coated with DNA to be bombarded with gene gun are made up of.",
                options: ["Silicon or Platinum", "Gold or Tungsten", "Silver or platinum", "Platinum or zinc"],
                answer: "Gold or Tungsten",
                explanation: "For the purpose, cells are bombarded with high-velocity micro-particles of gold or tungsten coated with DNA."
            }
        ];
    

        // --- State Variables ---
        let currentQuestionIndex = 0;
        let userAnswers = new Array(quizData.length).fill(null);
        let questionStatus = new Array(quizData.length).fill('default');
        let markedForReview = new Array(quizData.length).fill(false);
        let timeSpentPerQuestion = new Array(quizData.length).fill(0);
        let questionTimerInterval;
        let totalTimerInterval;
        let questionViewStartTime = null;
        let totalTimeSeconds = 50 * 60;
        let userName = "";
        let timeChart = null;
        const QUESTION_TIME_LIMIT = 50;

        // --- DOM Elements ---
        const landingPage = document.getElementById('landing-page');
        const quizPage = document.getElementById('quiz-page');
        const resultsPage = document.getElementById('results-page');
        const nameInput = document.getElementById('name-input');
        const startQuizButton = document.getElementById('start-quiz-button');
        const userNameDisplay = document.getElementById('user-name');
        const resultUserNameDisplay = document.getElementById('result-user-name');
        const totalTimerDisplay = document.getElementById('total-timer');
        const questionNavList = document.getElementById('question-nav-list');
        const currentQuestionNumberDisplay = document.getElementById('current-question-number');
        const questionTimerDisplay = document.getElementById('question-timer');
        const questionText = document.getElementById('question-text');
        const optionsList = document.getElementById('options-list');
        const prevButton = document.getElementById('prev-button');
        const reviewButton = document.getElementById('review-button');
        const nextButton = document.getElementById('next-button');
        const scoreDisplay = document.getElementById('score');
        const totalMarksDisplay = document.getElementById('total-marks');
        const wrongUnansweredList = document.getElementById('wrong-unanswered-list');
        const timeChartCanvas = document.getElementById('timeChart');
        const imageContainer = document.getElementById('question-image-container'); // <-- Get image container

        // --- Functions ---

        function showPage(pageId) {
            landingPage.classList.add('hidden');
            quizPage.classList.add('hidden');
            resultsPage.classList.add('hidden');
            const pageToShow = document.getElementById(pageId);
            if (pageToShow) {
                pageToShow.classList.remove('hidden');
            }
        }

        function startQuiz() {
            userName = nameInput.value.trim() || "Rika xaxa";
            userNameDisplay.textContent = userName;
            resultUserNameDisplay.textContent = userName;
            showPage('quiz-page');

            totalMarksDisplay.textContent = quizData.length;
            initializeQuestionNav();
            loadQuestion(currentQuestionIndex);
            startTotalTimer();
        }

        function initializeQuestionNav() {
            questionNavList.innerHTML = '';
            quizData.forEach((_, index) => {
                const li = document.createElement('li');
                li.textContent = index + 1;
                li.classList.add('question-nav-item', `status-${questionStatus[index]}`);
                li.dataset.index = index;
                li.addEventListener('click', () => navigateToQuestion(index));
                questionNavList.appendChild(li);
            });
             updateQuestionNavHighlight();
        }

        function updateQuestionNavHighlight() {
             const items = questionNavList.querySelectorAll('.question-nav-item');
             items.forEach((item, index) => {
                 item.style.borderColor = '';
                 item.style.borderWidth = '';
                 if (index === currentQuestionIndex) {
                     item.style.borderColor = '#007bff';
                     item.style.borderWidth = '2px';
                 }
             });
        }


        function updateSingleQuestionNavStatus(index) {
            const item = questionNavList.querySelector(`.question-nav-item[data-index="${index}"]`);
            if (item) {
                item.classList.remove('status-default', 'status-answered', 'status-unanswered', 'status-review', 'status-answered-review');
                item.classList.add(`status-${questionStatus[index]}`);
            }
        }

        function recordTimeSpent() {
            if (questionViewStartTime !== null) {
                const timeElapsedThisVisit = (Date.now() - questionViewStartTime) / 1000;
                if (timeElapsedThisVisit > 0) {
                    timeSpentPerQuestion[currentQuestionIndex] += timeElapsedThisVisit;
                }
                questionViewStartTime = null;
            }
        }

        function updateStatus(index) {
            const answered = userAnswers[index] !== null;
            const reviewed = markedForReview[index];
            let currentStatus = questionStatus[index];
            let newStatus = currentStatus;

            if (answered && reviewed) {
                newStatus = 'answered-review';
            } else if (answered && !reviewed) {
                newStatus = 'answered';
            } else if (!answered && reviewed) {
                newStatus = 'review';
            } else if (!answered && !reviewed) {
                if (currentStatus === 'unanswered') {
                    newStatus = 'unanswered';
                } else if (currentStatus === 'default') {
                     newStatus = 'default';
                } else {
                    newStatus = 'unanswered';
                }
            }

            if (newStatus !== currentStatus) {
                questionStatus[index] = newStatus;
                updateSingleQuestionNavStatus(index);
            }
        }

        function finalizeStatusOnLeave(index) {
            const answered = userAnswers[index] !== null;
            const reviewed = markedForReview[index];
            let finalStatus = questionStatus[index];

            if (!answered && !reviewed) {
                finalStatus = 'unanswered';
            } else if (answered && reviewed) {
                finalStatus = 'answered-review';
            } else if (answered && !reviewed) {
                finalStatus = 'answered';
            } else if (!answered && reviewed) {
                finalStatus = 'review';
            }

            if (finalStatus !== questionStatus[index]) {
                questionStatus[index] = finalStatus;
            }
            updateSingleQuestionNavStatus(index);
        }


        function loadQuestion(index) {
            const question = quizData[index];
            currentQuestionNumberDisplay.textContent = `Question ${index + 1} of ${quizData.length}`;
            questionText.textContent = question.question;

            // --- NEW: Handle Image Display ---
            imageContainer.innerHTML = ''; // Clear previous image
            if (question.image) {
                const imgElement = document.createElement('img');
                imgElement.src = question.image;
                imgElement.alt = `Image for question ${index + 1}`; // Add alt text
                // Style applied via CSS now
                imageContainer.appendChild(imgElement);
            }
            // --- END NEW ---

            optionsList.innerHTML = '';
            question.options.forEach((option, i) => {
                const li = document.createElement('li');
                const inputId = `q${index}_option${i}`;
                const input = document.createElement('input');
                input.type = 'radio';
                input.name = `question${index}`;
                input.value = option;
                input.id = inputId;
                input.checked = userAnswers[index] === option;
                input.addEventListener('change', () => {
                    userAnswers[index] = option;
                    updateStatus(index);
                });

                const label = document.createElement('label');
                label.htmlFor = inputId;
                label.textContent = option;

                li.appendChild(input);
                li.appendChild(label);
                optionsList.appendChild(li);
            });

            prevButton.disabled = index === 0;
            nextButton.textContent = index === quizData.length - 1 ? 'Submit' : 'Next';

            reviewButton.textContent = markedForReview[index] ? 'Unmark Review' : 'Mark for Review';
            reviewButton.style.backgroundColor = markedForReview[index] ? '#5a32a3' : '#6f42c1';

            questionViewStartTime = Date.now();
            startQuestionTimer();

            updateQuestionNavHighlight();

            const questionAreaWrapper = document.querySelector('.question-area-wrapper');
            if (questionAreaWrapper) questionAreaWrapper.scrollTop = 0;
        }

        function navigateToQuestion(index) {
            if (index < 0 || index >= quizData.length || index === currentQuestionIndex) return;

            const leavingIndex = currentQuestionIndex;
            recordTimeSpent();
            finalizeStatusOnLeave(leavingIndex);

            currentQuestionIndex = index;
            loadQuestion(currentQuestionIndex);
        }

        function handleNext() {
             const leavingIndex = currentQuestionIndex;
             recordTimeSpent();
             finalizeStatusOnLeave(leavingIndex);

             if (currentQuestionIndex < quizData.length - 1) {
                currentQuestionIndex++;
                loadQuestion(currentQuestionIndex);
            } else {
                submitQuiz();
            }
        }

        function handlePrev() {
            const leavingIndex = currentQuestionIndex;
            recordTimeSpent();
            finalizeStatusOnLeave(leavingIndex);

            if (currentQuestionIndex > 0) {
               currentQuestionIndex--;
               loadQuestion(currentQuestionIndex);
            }
        }

        function toggleReview() {
            markedForReview[currentQuestionIndex] = !markedForReview[currentQuestionIndex];
            updateStatus(currentQuestionIndex);
            reviewButton.textContent = markedForReview[currentQuestionIndex] ? 'Unmark Review' : 'Mark for Review';
            reviewButton.style.backgroundColor = markedForReview[currentQuestionIndex] ? '#5a32a3' : '#6f42c1';
        }


        function startQuestionTimer() {
            clearInterval(questionTimerInterval);

            function updateTimerDisplay() {
                let totalTimeSpentSoFar = timeSpentPerQuestion[currentQuestionIndex];
                let timeElapsedThisVisit = 0;

                if (questionViewStartTime) {
                    timeElapsedThisVisit = (Date.now() - questionViewStartTime) / 1000;
                }

                let currentTotalTime = totalTimeSpentSoFar + timeElapsedThisVisit;
                let displayTime = Math.round(currentTotalTime);

                questionTimerDisplay.classList.remove('red');

                if (currentTotalTime > QUESTION_TIME_LIMIT) {
                    let exceededTime = Math.round(currentTotalTime - QUESTION_TIME_LIMIT);
                    questionTimerDisplay.textContent = `Exceeded: ${exceededTime}s`;
                    questionTimerDisplay.classList.add('red');
                } else {
                     questionTimerDisplay.textContent = `Time: ${displayTime}s`;
                }
            }

            updateTimerDisplay();
            questionTimerInterval = setInterval(updateTimerDisplay, 1000);
        }

        function startTotalTimer() {
            clearInterval(totalTimerInterval);
            let currentTime = totalTimeSeconds;

            totalTimerInterval = setInterval(() => {
                currentTime--;
                if (currentTime <= 0) {
                    clearInterval(totalTimerInterval);
                    totalTimerDisplay.textContent = '00:00';
                    alert("Time's up!");
                    submitQuiz();
                } else {
                    const minutes = Math.floor(currentTime / 60);
                    const seconds = currentTime % 60;
                    totalTimerDisplay.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                }
            }, 1000);
        }

        function submitQuiz() {
            recordTimeSpent();
            finalizeStatusOnLeave(currentQuestionIndex);
            clearInterval(questionTimerInterval);
            clearInterval(totalTimerInterval);

             questionStatus.forEach((status, index) => {
                 if (index !== currentQuestionIndex) {
                     finalizeStatusOnLeave(index);
                 }
             });

            calculateResults();
            showPage('results-page');
        }

        function calculateResults() {
            let score = 0;
            wrongUnansweredList.innerHTML = '';

            quizData.forEach((question, index) => {
                const isCorrect = userAnswers[index] === question.answer;
                if (isCorrect) {
                    score++;
                }

                if (questionStatus[index] === 'unanswered' || (userAnswers[index] !== null && !isCorrect)) {
                    const resultItem = document.createElement('div');
                    resultItem.classList.add('result-item');

                    const qText = document.createElement('p');
                    qText.classList.add('question');
                    qText.innerHTML = `<strong>Q${index + 1}:</strong> ${question.question}`;
                    resultItem.appendChild(qText);

                    const yourAns = document.createElement('p');
                    yourAns.innerHTML = `<strong>Your Answer:</strong> `;
                    if (userAnswers[index] !== null) {
                         yourAns.innerHTML += `<span class="your-answer">${userAnswers[index]}</span>`;
                    } else {
                         yourAns.innerHTML += `<span class="your-answer">Not Answered</span>`;
                    }
                     resultItem.appendChild(yourAns);


                    const correctAns = document.createElement('p');
                    correctAns.innerHTML = `<strong>Correct Answer:</strong> <span class="correct-answer">${question.answer}</span>`;
                    resultItem.appendChild(correctAns);

                    const explanation = document.createElement('p');
                    explanation.classList.add('explanation');
                    explanation.textContent = question.explanation;
                    resultItem.appendChild(explanation);

                    wrongUnansweredList.appendChild(resultItem);
                }
            });

            scoreDisplay.textContent = score;
            totalMarksDisplay.textContent = quizData.length;

            setTimeout(generateTimeChart, 100);
        }

         function generateTimeChart() {
            const ctx = timeChartCanvas.getContext('2d');
             if (!ctx) {
                console.error("Failed to get canvas context for time chart.");
                return;
            }
            const labels = quizData.map((_, index) => `Q${index + 1}`);
            const data = timeSpentPerQuestion.map(time => Math.round(time));

            const normalColor = 'rgba(0, 123, 255, 0.3)';
            const exceededColor = 'rgba(220, 53, 69, 0.3)';
            const normalBorder = 'rgba(0, 123, 255, 1)';
            const exceededBorder = 'rgba(220, 53, 69, 1)';

            if (timeChart) {
                timeChart.destroy();
            }

            try {
                timeChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Time Spent (seconds)',
                                data: data,
                                fill: true,
                                tension: 0.3,
                                segment: {
                                    borderColor: ctx => (ctx.p1.parsed.y > QUESTION_TIME_LIMIT) ? exceededBorder : normalBorder,
                                    backgroundColor: ctx => {
                                        const y1 = ctx.p0.parsed.y;
                                        const y2 = ctx.p1.parsed.y;
                                        return (y1 > QUESTION_TIME_LIMIT || y2 > QUESTION_TIME_LIMIT) ? exceededColor : normalColor;
                                    }
                                },
                                 pointBackgroundColor: ctx => data[ctx.dataIndex] > QUESTION_TIME_LIMIT ? exceededBorder : normalBorder,
                                 pointBorderColor: '#fff',
                                 pointHoverBackgroundColor: '#fff',
                                 pointHoverBorderColor: ctx => data[ctx.dataIndex] > QUESTION_TIME_LIMIT ? exceededBorder : normalBorder,

                            },
                            {
                                type: 'line',
                                label: `${QUESTION_TIME_LIMIT}s Threshold`,
                                data: Array(quizData.length).fill(QUESTION_TIME_LIMIT),
                                borderColor: 'rgba(220, 53, 69, 0.8)',
                                borderWidth: 2,
                                borderDash: [5, 5],
                                fill: false,
                                pointRadius: 0,
                                pointHoverRadius: 0
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Time (seconds)'
                                }
                            },
                            x: {
                                 title: {
                                    display: true,
                                    text: 'Question Number'
                                }
                            }
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        if (context.datasetIndex === 1) return null;
                                        let label = context.dataset.label || '';
                                        if (label) label += ': ';
                                        if (context.parsed.y !== null) label += context.parsed.y + 's';
                                        return label;
                                    }
                                }
                            }
                        },
                         interaction: {
                            intersect: false,
                            mode: 'index',
                        },
                    }
                });
            } catch (error) {
                console.error("Chart.js error:", error);
            }
        }

        // --- Event Listeners ---
        startQuizButton.addEventListener('click', startQuiz);
        prevButton.addEventListener('click', handlePrev);
        nextButton.addEventListener('click', handleNext);
        reviewButton.addEventListener('click', toggleReview);

         nameInput.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                startQuizButton.click();
            }
        });

        // --- Initial Setup ---
        showPage('landing-page');

    </script>

</body>
</html>